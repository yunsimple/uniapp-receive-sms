<template>
	<view>
		<view v-for="(item, index) in alertList">
			<u-alert-my class="u-alert-item" :title="item.title" :type="item.type" :closable="item.isClose" @click="description(index)" @close="closeAlert(item.id)"></u-alert-my>
		</view>
		<u-modal :show="modalShow" :title="alertList[clickCurrent]['title']" :content="alertList[clickCurrent]['description']" @confirm="closeModal"></u-modal>
	</view>
</template>

<script>
	import {
		http
	} from '@/utils/request.js'
	export default {
		data() {
			return {
				alertList: [{
					id: 1588, //用来标记关闭
					title: '系统正式公测，欢迎试用！！！',
					type: 'success',
					isClose: true,
					description: '有奖公测，欢迎提交BUG，建议！！！'
				}],
				modalShow: false,
				clickCurrent: 0
				
			}
		},
		methods: {
			description(e){
				this.clickCurrent = e
				this.modalShow = true
			},
			closeModal(){
				this.modalShow = false
			},
			//todo 关闭后localstorage标记，其他页面都不给予显示，直接下次请求，下次获取alertList数据时，遍历一下，看是否存在，否则关闭
			closeAlert(e){
				console.log(e)
				uni.setStorage({
					key: 'notice' + e,
					data: e
				})
			}
		}
	}
</script>

<style>
	.u-alert-item {
		margin-top: 10rpx;
	}
</style>
